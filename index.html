<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>India 360</title>
    <style>
      html {
        height: 100%;
      }

      /* Base Styles */
      :root {
        --header-text: #f0ecec;
        --icon-bg: rgb(6 3 3 / 7%);
        --icon-active-bg: rgba(0, 0, 0, 0.1);
        --tooltip-bg: rgba(0, 0, 0, 0.8);
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        height: 100%;
        overflow: hidden;
        margin: 0;
        padding: 0;
        font-family: Arial, Helvetica, sans-serif;
        font-size: 16px;
      }
      .footer-note {
        position: fixed;
        bottom: 80px;
        right: 20px;
        background-color: #1a1a1a;
        color: white;
        padding: 12px 16px;
        border-radius: 12px;
        font-family: sans-serif;
        font-size: 14px;
        opacity: 0.85;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        z-index: 999;
        transition: opacity 0.3s ease;
      }

      .footer-note:hover {
        opacity: 1;
      }

      .prototype-text {
        font-style: italic;
        color: #cccccc;
        margin-top: 4px;
      }

      /* Header Styles */
      .header {
        border-radius: 4px;
        height: 48px;
        box-shadow: 0 2px 8px 0 rgb(0 0 0 / 20%);
        background-color: #fff;
        display: flex;
        align-items: center;
        position: fixed;
        top: 8px;
        left: 8px;
        width: calc(100% - 16px);
        z-index: 1;
        justify-content: space-between;
        padding: 0 20px;
        box-sizing: border-box;
        background: rgb(0 0 0 / 19%);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 12px;
      }

      /* Logo Section */
      .logo {
        font-weight: bold;
        font-size: 1.25rem;
        letter-spacing: 0.025em;
        white-space: nowrap;
        color: var(--header-text);
      }

      /* Mobile Menu Button */
      .mobile-menu-button {
        display: none;
        background: transparent;
        border: none;
        color: var(--header-text);
        cursor: pointer;
        padding: 0.5rem;
        border-radius: 4px;
        transition: background 0.2s ease;
      }

      .mobile-menu-button:hover {
        background: var(--icon-bg);
      }

      .mobile-menu-button svg {
        width: 16px;
        height: 16px;
      }

      /* Desktop Navigation */
      .desktop-nav {
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      /* Mobile Menu */
      .mobile-menu {
        display: none;
        position: fixed;
        top: 56px;
        left: 0;
        right: 0;
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(20px);
        padding: 12px;
        flex-direction: column;
        gap: 8px;
        z-index: 1000;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        border-bottom: 1px solid rgba(0, 0, 0, 0.1);
      }

      .mobile-menu.open {
        display: flex;
      }

      /* Icon Button Styles */
      .icon-button-container {
        position: relative;
        display: inline-block;
      }

      .icon-button {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 32px;
        height: 32px;
        border-radius: 4px;
        background: var(--icon-bg);
        border: none;
        color: var(--header-text);
        cursor: pointer;
        transition: background 0.2s ease;
      }

      .icon-button.active {
        background: var(--icon-active-bg);
      }

      .icon-button:hover {
        background: var(--icon-active-bg);
      }

      .icon-button svg {
        width: 16px;
        height: 16px;
      }

      /* Tooltip Styles */
      .tooltip {
        position: absolute;
        bottom: -28px;
        left: 50%;
        transform: translateX(-50%);
        padding: 4px 8px;
        background: var(--tooltip-bg);
        color: white;
        font-size: 0.75rem;
        font-weight: 500;
        border-radius: 4px;
        white-space: nowrap;
        opacity: 0;
        transition: opacity 0.2s ease;
        pointer-events: none;
        z-index: 1000;
      }

      .icon-button-container:hover .tooltip {
        opacity: 1;
      }

      /* Header Layout */
      .header-left {
        display: flex;
        align-items: center;
        justify-content: flex-start;
        gap: 1rem;
        flex: 0 0 auto;
      }

      .header-right {
        flex: 0 0 auto;
      }

      .header-center {
        flex: 1;
        text-align: center;
        white-space: nowrap;
        color: var(--header-text);
        overflow: hidden;
        text-overflow: ellipsis;
        padding: 0 1rem;
      }

      /* Search Box Styles */
      #searchBox {
        position: relative;
        margin-left: 12px;
      }

      #searchInput {
        padding: 6px 12px;
        border: 1px solid rgba(255, 255, 255, 0.3);
        border-radius: 6px;
        background: rgb(0 0 0 / 20%);
        color: white;
        backdrop-filter: blur(8px);
        font-size: 14px;
        width: 200px;
      }

      #searchInput:focus {
        outline: none;
        border-color: rgba(255, 255, 255, 0.5);
      }

      #searchSuggestions {
        list-style: none;
        padding: 0;
        margin: 4px 0 0 0;
        background: white;
        border: 1px solid #ccc;
        max-height: 150px;
        overflow-y: auto;
        position: absolute;
        z-index: 1000;
        width: 100%;
        border-radius: 6px;
      }

      #searchSuggestions li {
        padding: 6px 10px;
        cursor: pointer;
      }

      #searchSuggestions li:hover {
        background-color: #f0f0f0;
      }

      /* View Mode Menu */
      .view-mode-menu {
        position: absolute;
        top: 60px;
        right: 20px;
        /* background: white;
            */
        backdrop-filter: blur(12px);
        border-radius: 6px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        z-index: 9999;
      }

      .view-mode-item {
        padding: 10px 16px;
        cursor: pointer;
        /* background: white; */
        transition: background 0.2s;
      }

      .view-mode-item:hover {
        background: #f0f0f0;
      }

      .view-mode-item.active {
        background: #1a5a1a;
        color: white;
      }

      /* Help Panel Styles */
      .help-panel-container {
        position: fixed;
        top: 80px;
        left: 20px;
        background: white;
        width: 320px;
        border-radius: 12px;
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.3);
        z-index: 10000;
        overflow: hidden;
      }

      .help-panel-close {
        position: absolute;
        top: 15px;
        right: 15px;
        width: 24px;
        height: 24px;
        cursor: pointer;
        opacity: 0.7;
        transition: opacity 0.2s;
        z-index: 10;
      }

      .help-panel-close:hover {
        opacity: 1;
      }

      .help-panel-content {
        padding: 30px;
        position: relative;
        min-height: 400px;
        overflow: hidden;
      }

      .help-section {
        position: absolute;
        top: 30px;
        left: 30px;
        right: 30px;
        opacity: 0;
        transform: translateX(20px);
        transition: all 0.3s ease;
        pointer-events: none;
      }

      .help-section.active {
        opacity: 1;
        transform: translateX(0);
        pointer-events: all;
        transition-delay: 0.1s;
      }

      .help-title {
        font-size: 1.5rem;
        font-weight: 600;
        color: #4a6fa5;
        margin-bottom: 20px;
      }

      .help-message {
        margin-bottom: 30px;
        line-height: 1.6;
      }

      .help-message p {
        margin-bottom: 15px;
      }

      .controls-section {
        margin-top: 25px;
      }

      .controls-title {
        font-weight: 600;
        margin-bottom: 15px;
        color: #4a6fa5;
      }

      .control-item {
        margin-bottom: 12px;
        padding-left: 20px;
        position: relative;
      }

      .control-item:before {
        content: "‚Ä¢";
        position: absolute;
        left: 0;
        color: #4a6fa5;
      }

      .pagination {
        display: flex;
        justify-content: center;
        padding: 20px 0;
        background-color: #f8f9fa;
        border-top: 1px solid #ddd;
      }

      .pagination-item {
        width: 40px;
        height: 40px;
        display: flex;
        justify-content: center;
        align-items: center;
        margin: 0 5px;
        border-radius: 50%;
        cursor: pointer;
        font-weight: 500;
        transition: all 0.2s;
        border: 2px solid transparent;
      }

      .pagination-item:hover {
        background-color: rgba(74, 111, 165, 0.1);
      }

      .pagination-item.active {
        background-color: #4a6fa5;
        color: white;
        border-color: #4a6fa5;
      }

      /* Share Popup */
      .share-popup {
        position: fixed;
        top: 80px;
        right: 20px;
        width: 300px;
        background: #ffffff;
        border-radius: 10px;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.25);
        z-index: 9999;
        /* display: none; */
      }

      .share-popup.show {
        display: block;
        animation: fadeIn 0.3s ease-in-out;
      }

      .share-popup-header {
        background: #2a2a2f;
        color: white;
        padding: 12px 16px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-weight: bold;
        border-top-left-radius: 10px;
        border-top-right-radius: 10px;
      }

      .share-close-btn {
        background: none;
        border: none;
        color: white;
        font-size: 18px;
        cursor: pointer;
      }

      .share-popup-body {
        padding: 16px;
      }

      #shareLinkInput {
        width: 100%;
        padding: 8px;
        font-size: 14px;
        margin-bottom: 10px;
        border-radius: 5px;
        border: 1px solid #ccc;
      }

      #copyShareLinkBtn {
        width: 100%;
        background: #2a2a2f;
        color: white;
        padding: 10px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(-10px);
        }

        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .hidden {
        display: none !important;
      }

      /* RESPONSIVE STYLES */

      /* Tablet Styles (768px - 1023px) */
      @media (max-width: 1023px) {
        .header {
          padding: 0 16px;
        }

        .logo {
          font-size: 1.1rem;
        }

        #searchInput {
          width: 160px;
        }

        .help-panel-container {
          width: 280px;
          left: 16px;
        }

        .share-popup {
          width: 260px;
          right: 16px;
        }
      }

      /* Mobile Styles (below 768px) */
      @media (max-width: 767px) {
        .header {
          padding: 0 8px;
          height: 56px;
          top: 0;
          left: 0;
          width: 100%;
          border-radius: 0;
          flex-wrap: nowrap;
        }

        .mobile-menu-button {
          display: block;
          order: 2;
          margin-left: auto;
        }

        .header-left {
          order: 1;
          flex: 1;
          min-width: 0;
          overflow: hidden;
          gap: 0.5rem;
        }

        .header-center {
          order: 2;
          flex: 0 0 auto;
          padding: 0 8px;
          font-size: 14px;
          text-align: left;
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
          display: none;
        }

        .header-right {
          order: 4;
          width: 100%;
          display: none;
          justify-content: space-around;
          padding: 8px 0;
          backdrop-filter: blur(20px);
          position: fixed;
          top: 56px;
          left: 0;
          right: 0;
          z-index: 1000;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
          border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        .header-right.mobile-open {
          display: flex;
        }

        .desktop-nav {
          display: none;
        }

        .logo {
          font-size: 1rem;
        }

        /* Search box adjustments */
        #searchBox {
          position: absolute;
          top: 60px;
          left: 8px;
          right: 8px;
          margin-left: 0;
          z-index: 1001;
        }

        #searchInput {
          width: 100%;
          font-size: 13px;
          padding: 5px 8px;
        }

        /* Icon buttons in mobile */
        .icon-button {
          width: 36px;
          height: 36px;
        }

        .icon-button svg {
          width: 18px;
          height: 18px;
        }

        /* Tooltips on mobile */
        .tooltip {
          /* position: fixed; */
          bottom: auto;
          top: 120%;
          left: 50%;
          transform: translate(-50%, -50%);
          background: rgba(0, 0, 0, 0.8);
          padding: 5px 5px;
          border-radius: 4px;
          font-size: 10px;
          opacity: 0;
          transition: opacity 0.2s;
          pointer-events: none;
          z-index: 99999999;
        }

        .icon-button-container.show-tooltip .tooltip {
          opacity: 1;
        }

        /* Help panel adjustments */
        .help-panel-container {
          width: calc(100vw - 16px);
          left: 8px !important;
          top: 70px !important;
          max-height: 70vh;
          overflow-y: auto;
        }

        .help-panel-content {
          padding: 20px;
          min-height: 320px;
        }

        .help-section {
          top: 20px;
          left: 20px;
          right: 20px;
        }

        .help-title {
          font-size: 1.3rem;
          margin-bottom: 15px;
        }

        .pagination-item {
          width: 35px;
          height: 35px;
          font-size: 0.9rem;
        }

        /* Share popup adjustments */
        .share-popup {
          width: calc(100vw - 16px);
          left: 8px !important;
          right: 8px !important;
          top: 70px !important;
        }

        /* View mode menu adjustments */
        .view-mode-menu {
          right: 8px !important;
          left: 8px !important;
          top: 70px !important;
          width: calc(100vw - 16px);
        }

        /* Show scene title when menu is open */
        .header-right.mobile-open ~ .header-center {
          display: block;
          position: absolute;
          left: 50%;
          transform: translateX(-50%);
          width: auto;
          max-width: 60%;
        }
      }

      /* Small Mobile Styles (below 480px) */
      @media (max-width: 479px) {
        .header {
          padding: 0 8px;
        }

        .header-left {
          gap: 0.25rem;
        }

        .logo {
          font-size: 0.9rem;
        }

        .header-center {
          font-size: 0.8rem;
          padding: 0 0.25rem;
        }

        #searchInput {
          width: 100%;
          font-size: 12px;
        }

        .icon-button {
          width: 32px;
          height: 32px;
        }

        .icon-button svg {
          width: 16px;
          height: 16px;
        }

        .help-panel-content {
          padding: 15px;
          min-height: 280px;
        }

        .help-section {
          top: 15px;
          left: 15px;
          right: 15px;
        }

        .help-title {
          font-size: 1.1rem;
          margin-bottom: 12px;
        }

        .help-message p {
          font-size: 0.9rem;
          margin-bottom: 10px;
        }

        .controls-title {
          font-size: 0.95rem;
        }

        .control-item {
          font-size: 0.85rem;
          margin-bottom: 10px;
        }

        .pagination-item {
          width: 30px;
          height: 30px;
          font-size: 0.8rem;
          margin: 0 3px;
        }
      }

      /* Landscape orientation adjustments */
      @media (max-height: 480px) and (orientation: landscape) {
        .header {
          height: 48px;
        }

        .header-right {
          top: 48px;
        }

        .help-panel-container,
        .share-popup,
        .view-mode-menu {
          top: 58px !important;
          max-height: 60vh;
        }
      }

      /* Animation for mobile nav */
      @keyframes slideDown {
        from {
          opacity: 0;
          transform: translateY(-10px);
        }

        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      #searchSuggestions li {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 6px 10px;
        cursor: pointer;
        overflow: hidden;
      }

      #searchSuggestions li .search-thumb {
        width: 36px;
        height: 36px;
        object-fit: cover;
        border-radius: 4px;
        flex-shrink: 0;
        background: #eee;
        margin-right: 8px;
        display: block;
      }

      #searchSuggestions li span {
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        flex: 1;
      }

      .scene-toggle-btn {
        position: fixed;
        bottom: 30px;
        left: 0px;
        padding: 12px 18px;
        font-size: 16px;
        border: none;
        background-color: white;
        color: black;
        border-bottom-right-radius: 25px;
        border-top-right-radius: 25px;
        cursor: pointer;
        z-index: 9999;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
      }
      .arrow-icon {
        width: 25px;
        height: 20px;
        margin-right: 8px;
        padding-bottom: 2px;
        padding-left: 2px;
        vertical-align: middle;
      }
      .arrow-icon:hover {
        transform: translateX(5px);
        transition: transform 0.3s ease;
      }
      .scene-preview {
        position: fixed;
        bottom: 30px;
        left: 5px;
        width: 400px;
        max-height: 450px;
        background: white;
        color: black;
        border-radius: 20px;
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.4);
        padding: 20px;
        z-index: 9998;
        overflow-y: hidden;
        scrollbar-width: thin;
        display: none;
        scrollbar-color: #e2e2e2 transparent;
      }
      @keyframes slideInFromLeft {
        0% {
          transform: translateX(-100%);
          opacity: 0;
        }
        100% {
          transform: translateX(0);
          opacity: 1;
        }
      }

      @keyframes slideOutToLeft {
        0% {
          transform: translateX(0);
          opacity: 1;
        }
        100% {
          transform: translateX(-100%);
          opacity: 0;
        }
      }

      .slide-in-left {
        animation: slideInFromLeft 0.4s ease-out forwards;
      }

      .slide-out-left {
        animation: slideOutToLeft 0.4s ease-in forwards;
      }

      .scene-preview h2 {
        margin-top: 0;
        text-align: center;
        margin-bottom: 10px;
      }

      .scene-card {
        display: flex;
        align-items: center;
        background: #f4f4f4;
        color: black;
        border-radius: 10px;
        margin-bottom: 10px;
        padding: 10px;
      }

      .scene-card img {
        width: 80px;
        height: 80px;
        border-radius: 8px;
        object-fit: cover;
      }

      .scene-card .info {
        flex: 1;
        margin-left: 15px;
      }

      .scene-card .info h3 {
        margin: 0;
        font-size: 16px;
      }

      .scene-card .info button {
        margin-top: 6px;
        padding: 4px 10px;
        font-size: 14px;
        border: none;
        background-color: #333;
        color: white;
        border-radius: 6px;
        cursor: pointer;
      }

      .closebtn:hover {
        background: #aaa;
        float: right;
        font-size: 22px;
        font-weight: bold;
      }
      .scene-card:hover {
        background-color: lightblue;
      }

      /* üîÅ Responsive Styles */
      @media (max-width: 768px) {
        .scene-preview {
          left: 10px;
          right: 10px;
          width: auto;
          max-height: 80vh;
          border-radius: 15px;
          padding: 15px;
        }

        .scene-card {
          flex-direction: column;
          align-items: flex-start;
          padding: 10px;
        }

        .scene-card img {
          width: 100%;
          height: auto;
          margin-bottom: 10px;
        }

        .scene-card .info {
          margin-left: 0;
          width: 100%;
        }

        .scene-card .info h3 {
          font-size: 15px;
        }

        .scene-card .info button {
          width: 100%;
          font-size: 14px;
          padding: 6px 12px;
        }

        .scene-toggle-btn {
          font-size: 14px;
          padding: 10px 16px;
          bottom: 20px;
          left: 0;
        }
      }

      @media (max-width: 480px) {
        .scene-preview {
          max-height: 60vh;
          padding: 14px;
        }

        .scene-card .info h3 {
          font-size: 14px;
        }

        .scene-toggle-btn {
          font-size: 13px;
          padding: 8px 8px;
          bottom: 32px;
        }
      }
      .scroll-container {
        max-height: 400px;
        padding: 6px;
        overflow-y: auto;
        scrollbar-width: thin; /* Firefox */
        scrollbar-color: #ffffff transparent; /* Firefox */
      }

      .scroll-container::-webkit-scrollbar {
        width: 1px;
      }

      .scroll-container::-webkit-scrollbar-button {
        display: none;
      }

      .scroll-container::-webkit-scrollbar-thumb {
        background-color: #e3e3e3;
        border-radius: 15px;
      }
      .scene-card {
        display: flex;
        gap: 5px;
        padding: 15px;
        margin-bottom: 20px;
        background: rgba(62, 62, 62, 0.08);
        border-radius: 16px;
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: black;
        cursor: pointer;
        text-align: center;
        transition: transform 0.2s ease;
      }

      .scene-card:hover {
        transform: scale(1.02);
      }

      .scene-thumb {
        width: 140px;
        height: auto;
        border-radius: 12px;
        object-fit: cover;
      }

      .scene-info h3 {
        margin: 0 0 10px 0;
        font-size: 18px;
        padding-left: 10px;
      }

      .scene-info p {
        margin: 0;
        font-size: 14px;
        opacity: 0.8;
      }
    </style>
  </head>

  <body>
    <script src="tour.js"></script>
    <header class="header">
      <!-- Mobile Menu Button -->

      <!-- Help Panel -->
      <div class="help-panel-container hidden">
        <svg
          class="help-panel-close"
          viewBox="0 0 24 24"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            fill="var(--close-btn-color)"
            d="M20.48 4.93L19.07 3.52 12 10.59 4.93 3.52 3.52 4.93 10.59 12 3.52 19.07 4.93 20.48 12 13.41 19.07 20.48 20.48 19.07 13.41 12 20.48 4.93z"
          />
        </svg>

        <div class="help-panel-content">
          <div class="help-section active" data-page="1">
            <h2 class="help-title">Welcome</h2>
            <div class="help-message">
              <p>
                Our platform contains 360¬∞ photos and videos for an immersive
                experience.
              </p>
              <p>
                Rotate and zoom the image using the controls, your mouse, or
                touch screen gestures.
              </p>
              <p>
                Navigate between different media using hotspots, the interactive
                map, or thumbnail galleries.
              </p>
            </div>
          </div>

          <div class="help-section" data-page="2">
            <h2 class="help-title">Controls</h2>
            <div class="help-message">
              <p>
                Here are the main controls available to enhance your experience:
              </p>
            </div>
            <div class="controls-section">
              <h3 class="controls-title">Navigation</h3>
              <div class="control-item">Go to the nearest hub location</div>
              <div class="control-item">
                Share your current view with others
              </div>
              <div class="control-item">
                Provide feedback about your experience
              </div>
              <div class="control-item">
                View detailed descriptions of scenes
              </div>
            </div>
            <!-- <div class="controls-section">
              <h3 class="controls-title">Exploration</h3>
              <div class="control-item">Discover nearby and related scenes</div>
              <div class="control-item">
                Adjust video quality and playback speed
              </div>
              <div class="control-item">Search media by name or category</div>
            </div> -->
          </div>

          <div class="help-section" data-page="3">
            <h2 class="help-title">Tips & Tricks</h2>
            <div class="help-message">
              <p>Get the most out of your 360¬∞ experience with these tips:</p>
            </div>
            <div class="controls-section">
              <div class="control-item">
                Use keyboard arrows for smooth rotation
              </div>
              <div class="control-item">
                Double-click/tap to quickly zoom in
              </div>
              <div class="control-item">
                Enable VR mode for immersive viewing
              </div>
              <div class="control-item">Bookmark favorite locations</div>
              <div class="control-item">Try the automatic tour mode</div>
            </div>
          </div>
        </div>

        <div class="pagination">
          <div class="pagination-item active" data-target="1">1</div>
          <div class="pagination-item" data-target="2">2</div>
          <div class="pagination-item" data-target="3">3</div>
        </div>
      </div>

      <div class="header-left">
        <!-- Left Logo Section -->
        <div class="logo">INDIA 360</div>

        <!-- Search Button -->
        <div class="icon-button-container">
          <button class="icon-button" data-id="search" id="searchButton">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <circle cx="11" cy="11" r="8"></circle>
              <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
            </svg>
          </button>
          <!-- <div class="tooltip">Search</div> -->
        </div>

        <!-- Search Box -->
        <div id="searchBox" style="display: none">
          <input type="text" id="searchInput" placeholder="Search scene..." />
          <ul id="searchSuggestions" class="search-suggestions"></ul>
        </div>
      </div>

      <!-- Scene Title -->
      <div class="center-text header-center" id="sceneTitle">loading...</div>

      <button class="mobile-menu-button" id="mobileMenuButton">
        <svg
          id="mobileMenuIcon"
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <line x1="3" y1="12" x2="21" y2="12"></line>
          <line x1="3" y1="6" x2="21" y2="6"></line>
          <line x1="3" y1="18" x2="21" y2="18"></line>
        </svg>
      </button>
      <!-- Right Icons -->
      <div class="desktop-nav header-right" id="rightIcons">
        <!-- Info -->
        <div class="icon-button-container">
          <button class="icon-button" data-id="info" id="helpButton">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <circle cx="12" cy="12" r="10" />
              <line x1="12" y1="16" x2="12" y2="12" />
              <line x1="12" y1="8" x2="12.01" y2="8" />
            </svg>
          </button>
          <div class="tooltip">Info</div>
        </div>

        <!-- Share -->
        <div class="icon-button-container">
          <button class="icon-button" data-id="share" id="shareButton">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <circle cx="18" cy="5" r="3" />
              <circle cx="6" cy="12" r="3" />
              <circle cx="18" cy="19" r="3" />
              <line x1="8.59" y1="13.51" x2="15.42" y2="17.49" />
              <line x1="15.41" y1="6.51" x2="8.59" y2="10.49" />
            </svg>
          </button>
          <div class="tooltip">Share</div>
        </div>

        <!-- Tour Mode -->
        <div class="icon-button-container">
          <button class="icon-button" data-id="tour" id="tourButton">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <polygon points="5 3 19 12 5 21 5 3" />
            </svg>
          </button>
          <div class="tooltip">Tour mode</div>
        </div>

        <!-- Fullscreen -->
        <div class="icon-button-container">
          <button
            class="icon-button"
            data-id="fullscreen"
            id="fullscreenButton"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <path
                d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"
              />
            </svg>
          </button>
          <div class="tooltip">Fullscreen</div>
        </div>

        <!-- View Mode -->
        <div class="icon-button-container">
          <button class="icon-button" data-id="view" id="viewButton">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" />
              <circle cx="12" cy="12" r="3" />
            </svg>
          </button>
          <div class="tooltip">View mode</div>
        </div>
      </div>

      <!-- Share Popup -->
      <div id="sharePopup" class="share-popup hidden">
        <div class="share-popup-header">
          <span>Share this view</span>
          <button id="closeSharePopup" class="share-close-btn">&times;</button>
        </div>
        <div class="share-popup-body">
          <input id="shareLinkInput" readonly />
          <button id="copyShareLinkBtn">Copy Link</button>
        </div>
      </div>
    </header>

    <!-- View Mode Menu -->
    <div id="viewModeMenu" class="view-mode-menu hidden">
      <div class="view-mode-item active" data-mode="rectilinear">
        Rectilinear
      </div>
      <div class="view-mode-item" data-mode="littleplanet">Little Planet</div>
      <div class="view-mode-item" data-mode="fisheye">Fisheye</div>
      <div class="view-mode-item" data-mode="pannini">Pannini</div>
      <div class="view-mode-item" data-mode="stereographic">Stereographic</div>
      <div class="view-mode-item" data-mode="architectural">Architectural</div>
    </div>

    <div id="pano" style="width: 100%; height: 100%">
      <noscript>
        <table style="width: 100%; height: 100%">
          <tr style="vertical-align: middle">
            <td>
              <div style="text-align: center">
                ERROR:<br /><br />Javascript not activated<br /><br />
              </div>
            </td>
          </tr>
        </table>
      </noscript>
    </div>

    <button id="scenePreviewBtn" class="scene-toggle-btn">
      Scene Preview
      <img src="right.png" alt="‚Üí" class="arrow-icon" />
    </button>
    <div id="scenePreviewPanel" class="scene-preview">
      <button
        onclick="closeScenePreview()"
        style="
          position: absolute;
          top: 18px;
          right: 30px;
          cursor: pointer;
          border: none;
          background: none;
          font-size: 18px;
        "
        class="closebtn"
      >
        ‚úñ
      </button>
      <h2>Scene Preview</h2>

      <div class="scroll-container">
        <div id="sceneList" class="scene-list"></div>
      </div>
    </div>

    <div class="footer-note">
      <p><strong>Team</strong> - evolkun</p>
      <p><strong>Developed by</strong> - Shubham, Vinnet</p>
      <p class="prototype-text">This is a prototype with few images</p>
    </div>

    <script>
      document
        .getElementById("scenePreviewBtn")
        .addEventListener("click", function () {
          const panel = document.getElementById("scenePreviewPanel");
          const button = document.getElementById("scenePreviewBtn");

          const isOpen = panel.classList.contains("slide-in-left");

          if (isOpen) {
            panel.classList.remove("slide-in-left");
            panel.classList.add("slide-out-left");

            setTimeout(() => {
              panel.style.display = "none";
              button.style.display = "block";
              panel.classList.remove("slide-out-left");
            }, 400); // Match your transition duration
          } else {
            panel.style.display = "block";
            panel.classList.add("slide-in-left");
            button.style.display = "none";
          }
        });

      function closeScenePreview() {
        document.getElementById("scenePreviewPanel").style.display = "none";
        document.getElementById("scenePreviewBtn").style.display = "block";
      }
      // function createScenePreviewPanel(krpano) {
      //   const container = document.getElementById("sceneList");
      //   container.innerHTML = "";

      //   const sceneCount = krpano.get("scene.count");

      //   for (let i = 0; i < sceneCount; i++) {
      //     const name = krpano.get(`scene[${i}].name`);
      //     const title = krpano.get(`scene[${i}].title`);
      //     const thumburl = krpano.get(`scene[${i}].thumburl`);

      //     const card = document.createElement("div");
      //     card.className = "scene-card";
      //     card.onclick = function() {
      //       loadSceneByName(name);
      //       closeScenePreview();
      //     };
      //     card.style.cursor = "pointer";

      //     card.innerHTML = `
      //       <img src="${thumburl}" alt="${title}" />
      //       <div class="info">
      //         <h3>${title}</h3>
      //       </div>
      //     `;

      //     container.appendChild(card);
      //   }
      // }

      function createScenePreviewPanel(krpano) {
        const container = document.getElementById("sceneList");
        container.innerHTML = "";

        const sceneCount = krpano.get("scene.count");

        for (let i = 0; i < sceneCount; i++) {
          const name = krpano.get(`scene[${i}].name`);
          const title = krpano.get(`scene[${i}].title`);
          const thumburl = krpano.get(`scene[${i}].thumburl`);
          const description =
            krpano.get(`scene[${i}].description`) ||
            "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer nec odio. Praesent libero. Sed cursus ante dapibus diam.";

          // Card container
          const card = document.createElement("div");
          card.className = "scene-card";
          card.onclick = function () {
            loadSceneByName(name);
            closeScenePreview();
          };

          // Image
          const img = document.createElement("img");
          img.src = thumburl;
          img.alt = title;
          img.className = "scene-thumb";

          // Info wrapper
          const info = document.createElement("div");
          info.className = "scene-info";

          const heading = document.createElement("h3");
          heading.textContent = title;

          const desc = document.createElement("p");
          desc.textContent = description;

          info.appendChild(heading);
          info.appendChild(desc);

          // Combine
          card.appendChild(img);
          card.appendChild(info);
          container.appendChild(card);
        }
      }

      function loadSceneByName(sceneName) {
        const krpano = document.getElementById("krpanoSWFObject");
        krpano.call(`loadscene(${sceneName}, null, MERGE,BLEND(1));`);
        closeScenePreview();
        document.getElementById("scenePreviewPanel").style.display = "none";
      }

      let isTourRunning = false;
      let initialLoadHandled = false;
      let krpano = null;
      let sceneList = [];

      const urlParams = new URLSearchParams(window.location.search);
      const sceneToLoad = urlParams.get("scene");

      embedpano({
        swf: null,
        id: "krpanoSWFObject",
        xml: "tour.xml",
        target: "pano",
        html5: "only",
        mobilescale: 1.0,
        // consolelog: true,
        // passQueryParameters: true,
        onready: function (kr) {
          krpano = kr;
          createScenePreviewPanel(krpano);
          // console.log("Krpano is ready.");
          krpano.set("events.onxmlcomplete", function () {
            // console.log("Krpano XML parsing complete.");

            if (!initialLoadHandled) {
              if (sceneToLoad) {
                if (krpano.get("xml.scene") !== sceneToLoad) {
                  // console.log(
                  //   "Before krpano.call(loadscene) for initial URL load:",
                  //   sceneToLoad
                  // );
                  krpano.call(`loadscene(${sceneToLoad}, null, MERGE);`);
                  // console.log(
                  //   "After krpano.call(loadscene) for initial URL load:",
                  //   sceneToLoad
                  // );
                } else {
                  // console.log(
                  //   "Scene",
                  //   sceneToLoad,
                  //   "is already the current scene from URL."
                  // );
                }

                const currentURL = new URL(window.location.href);
                currentURL.searchParams.delete("scene");
                window.history.replaceState(
                  {},
                  document.title,
                  currentURL.toString()
                );
              } else {
                // console.log(
                //   "No specific scene specified in URL. Loading default scene."
                // );
              }
              initialLoadHandled = true;
            } else {
              // console.log(
              //   "onxmlcomplete triggered again, but initial load already handled."
              // );
            }

            updateSceneTitle();
            krpano.set("events.onnewscene", "js(updateSceneTitle());");
          });

          // Get all scenes from krpano
          const totalScenes = krpano.get("scene.count");
          for (let i = 0; i < totalScenes; i++) {
            const name = krpano.get(`scene[${i}].name`);
            const title = krpano.get(`scene[${i}].title`);
            const thumbUrl = krpano.get(`scene[${i}].thumburl`);
            sceneList.push({ name, title, thumbUrl });
          }
        },
      });

      document.addEventListener("DOMContentLoaded", function () {
        // Initialize responsive functionality
        initializeResponsive();

        // Tour Button
        const tourBtn = document.getElementById("tourButton");
        tourBtn.addEventListener("click", () => {
          tourButtonToggle(tourBtn);
        });

        // Fullscreen Button
        const fullscreenBtn = document.getElementById("fullscreenButton");
        fullscreenBtn.addEventListener("click", () => {
          fullscreenButton();
        });

        // View Button
        const viewButton = document.getElementById("viewButton");
        const viewMenu = document.getElementById("viewModeMenu");
        if (viewButton && viewMenu) {
          viewButton?.addEventListener("click", () => {
            // console.log("View button clicked, toggling view menu visibility.");
            const isVisible = !viewMenu.classList.contains("hidden");
            hideAllPopups();
            viewMenu.classList.toggle("hidden");
            if (!isVisible) {
              showProjectionMenu(viewButton, viewMenu);
            }
          });
        }

        // Help Button
        const helpButton = document.getElementById("helpButton");
        const closeBtn = document.querySelector(".help-panel-close");
        const helpPanel = document.querySelector(".help-panel-container");

        closeBtn.addEventListener("click", function () {
          helpPanel.classList.add("hidden");
        });

        helpButton?.addEventListener("click", () => {
          hideAllPopups();
          helpPanel.classList.toggle("hidden");
          // console.log("helpButton clicked");
          helpButtonFunc();
        });

        // Share Button
        const shareButton = document.getElementById("shareButton");
        const sharePopup = document.getElementById("sharePopup");
        const shareInput = document.getElementById("shareLinkInput");
        const copyBtn = document.getElementById("copyShareLinkBtn");
        const shareCloseBtn = document.getElementById("closeSharePopup");

        shareButton?.addEventListener("click", () => {
          if (!krpano) return;
          // console.log("sharebutton clicked");
          // Hide other popups first
          hideAllPopups();

          const sceneId = krpano.get("xml.scene");
          const currentUrl = window.location.origin + window.location.pathname;
          const shareUrl = `${currentUrl}?scene=${sceneId}`;

          shareInput.value = shareUrl;
          sharePopup.classList.toggle("hidden");
        });

        shareCloseBtn?.addEventListener("click", () => {
          sharePopup.classList.add("hidden");
        });

        copyBtn?.addEventListener("click", () => {
          shareInput.select();
          document.execCommand("copy");
          copyBtn.innerText = "Copied!";
          setTimeout(() => {
            copyBtn.innerText = "Copy Link";
          }, 1500);
        });

        // Mobile Menu functionality
        const mobileBtn = document.getElementById("mobileMenuButton");
        const rightIcons = document.getElementById("rightIcons");

        mobileBtn.addEventListener("click", (e) => {
          e.stopPropagation();
          toggleMobileMenu(rightIcons);
        });

        // Search Button
        const searchBtn = document.getElementById("searchButton");
        const searchBox = document.getElementById("searchBox");
        const searchInput = document.getElementById("searchInput");

        searchBtn.addEventListener("click", function (e) {
          e.stopPropagation();

          const isVisible = searchBox.style.display === "block";
          hideAllPopups();
          searchBox.style.display = isVisible ? "none" : "block";
        
          if (!isVisible) {
            closeMobileMenu(rightIcons);
            searchInput.focus();
            searchInput.value = "";
            document.getElementById("searchSuggestions").innerHTML = "";
          }
        });

        searchInput.addEventListener("keydown", function (e) {
          if (e.key === "Escape") {
            searchBox.style.display = "none";
          }
        });

        searchInput.addEventListener("input", filterScenes);

        // Close mobile menu when clicking outside
        document.addEventListener("click", (e) => {
          const rightIcons = document.getElementById("rightIcons");
          // Only close if menu is open and click is outside header
          if (
            rightIcons.classList.contains("mobile-open") &&
            !e.target.closest(".header")
          ) {
            // console.log("closeMobileMenu called.......");
            closeMobileMenu(rightIcons);
            hideAllPopups();
          }
        });

        // Handle screen resize
        window.addEventListener("resize", handleResize);

        // Info Button
        const infoButton = document.getElementById("infoButton");
        infoButton?.addEventListener("click", () => {
          hideAllPopups();
        });

        // Feedback Button
        const feedbackButton = document.getElementById("feedbackButton");
        feedbackButton?.addEventListener("click", () => {
          hideAllPopups();
        });
      });

      function initializeResponsive() {
        // Add touch-friendly tooltips for mobile
        const iconContainers = document.querySelectorAll(
          ".icon-button-container"
        );

        iconContainers.forEach((container) => {
          const button = container.querySelector(".icon-button");

          // Add touch events for mobile tooltip
          button.addEventListener("touchstart", (e) => {
            if (window.innerWidth <= 767) {
              // e.preventDefault();
              toggleTooltip(container);
            }
          });

          // Prevent tooltip from staying open on desktop
          button.addEventListener("mouseleave", () => {
            container.classList.remove("show-tooltip");
          });
        });
      }

      function toggleMobileMenu(rightIcons) {
        const isOpen = rightIcons.classList.contains("mobile-open");
        // console.log("mobile menu toggle clicked, isOpen:");
        if (isOpen) {
          closeMobileMenu(rightIcons);
        } else {
          // Close any open popups first
          hideAllPopups();

          rightIcons.classList.add("mobile-open");
          document.querySelector(".header-center").style.display = "block";

          // Update menu button icon to X
          updateMobileMenuIcon(true);
        }
      }

      function closeMobileMenu(rightIcons) {
        // console.log("closeMobileMenu called");
        rightIcons.classList.remove("mobile-open");
        // document.querySelector('.header-center').style.display = 'none';
        updateMobileMenuIcon(false);
      }

      function updateMobileMenuIcon(isOpen) {
        const icon = document.getElementById("mobileMenuIcon");
        if (isOpen) {
          // X icon
          icon.innerHTML = `
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                `;
        } else {
          // Hamburger icon
          icon.innerHTML = `
                    <line x1="3" y1="12" x2="21" y2="12"></line>
                    <line x1="3" y1="6" x2="21" y2="6"></line>
                    <line x1="3" y1="18" x2="21" y2="18"></line>
                `;
        }
      }

      function toggleTooltip(container) {
        // Remove tooltip from all other containers
        document.querySelectorAll(".icon-button-container").forEach((c) => {
          if (c !== container) {
            c.classList.remove("show-tooltip");
          }
        });

        // Toggle tooltip for this container
        container.classList.toggle("show-tooltip");

        // Auto-hide after 2 seconds
        setTimeout(() => {
          container.classList.remove("show-tooltip");
        }, 2000);
      }

      function hideAllPopups() {
        // Hide share popup
        const sharePopup = document.getElementById("sharePopup");
        sharePopup?.classList.add("hidden");

        // Hide help panel
        const helpPanel = document.querySelector(".help-panel-container");
        helpPanel?.classList.add("hidden");

        // Hide view mode menu
        const viewMenu = document.getElementById("viewModeMenu");
        viewMenu?.classList.add("hidden");

        // Hide search box
        const searchBox = document.getElementById("searchBox");
        if (searchBox) {
          searchBox.style.display = "none";
        }
      }

      function handleResize() {
        const rightIcons = document.getElementById("rightIcons");
        // console.log("objects resized, rightIcons:", rightIcons);
        // Close mobile menu on resize to desktop
        if (window.innerWidth > 767) {
          closeMobileMenu(rightIcons);
          document.querySelector(".header-center").style.display = "block";
        } else {
          document.querySelector(".header-center").style.display = "none";
        }

        // Hide all popups on resize
        hideAllPopups();
      }

      function updateSceneTitle() {
        if (!krpano) return;
        const sceneTitle = krpano.get("scene[get(xml.scene)].title");
        const titleElement = document.getElementById("sceneTitle");
        if (titleElement) {
          titleElement.innerText = sceneTitle || "Untitled Scene";
        }
      }

      function tourButtonToggle(tourBtn) {
        if (!krpano) return;

        const svg = tourBtn.querySelector("svg");
        if (isTourRunning) {
          krpano.call("autorotate.stop();");
          svg.innerHTML = `<polygon points="5 3 19 12 5 21 5 3"></polygon>`;
        } else {
          krpano.call("autorotate.start();");
          svg.innerHTML = `<rect x="6" y="4" width="4" height="16"></rect><rect x="14" y="4" width="4" height="16"></rect>`;
        }

        isTourRunning = !isTourRunning;
      }

      function fullscreenButton() {
        if (!document.fullscreenElement) {
          document.documentElement.requestFullscreen();
        } else {
          document.exitFullscreen();
        }
      }

      function showProjectionMenu(viewButton, viewMenu) {
        let currentViewMode = "rectilinear";

        // Mapping display names to KRpano view modes and their corresponding settings
        const viewModes = {
          Rectilinear: {
            fisheye: 0.0,
            stereographic: 0.0,
            architectural: 0.0,
          },
          "Little Planet": {
            fisheye: 1.4,
            stereographic: 1.0,
            architectural: 0.0,
          },
          Fisheye: {
            fisheye: 0.5,
            stereographic: 0.0,
            architectural: 0.0,
          },
          Pannini: {
            fisheye: 1.0,
            stereographic: 0.0,
            architectural: 1.0,
          },
          Stereographic: {
            fisheye: 1.0,
            stereographic: 1.0,
            architectural: 0.0,
          },
          Architectural: {
            fisheye: 0.0,
            stereographic: 0.0,
            architectural: 1.0,
          },
        };

        // Apply view mode on selection
        document.querySelectorAll(".view-mode-item").forEach((el) => {
          el.addEventListener("click", () => {
            const selected = el.getAttribute("data-mode");
            document
              .querySelectorAll(".view-mode-item")
              .forEach((i) => i.classList.remove("active"));
            el.classList.add("active");

            const selectedMode = el.innerText;
            const modeSettings = viewModes[selectedMode];

            if (krpano && modeSettings) {
              // Reset all projection-related parameters first
              krpano.set("view.fisheye", 0.0);
              krpano.set("view.stereographic", 0.0);
              krpano.set("view.architectural", 0.0);
              krpano.set("view.architecturalonlymiddle", 0.0);

              // Apply the selected mode's settings
              if (modeSettings.fisheye !== undefined) {
                krpano.set("view.fisheye", modeSettings.fisheye);
              }
              if (modeSettings.stereographic !== undefined) {
                krpano.set("view.stereographic", modeSettings.stereographic);
              }
              if (modeSettings.architectural !== undefined) {
                krpano.set("view.architectural", modeSettings.architectural);
              }

              krpano.call("lookat(view.h, view.v, view.fov);");
              viewMenu.classList.add("hidden");
              currentViewMode = selected;
            }
          });
        });
      }

      function helpButtonFunc() {
        const paginationItems = document.querySelectorAll(".pagination-item");
        const helpSections = document.querySelectorAll(".help-section");

        paginationItems.forEach((item) => {
          item.addEventListener("click", function () {
            const targetPage = this.getAttribute("data-target");
            switchPage(paginationItems, targetPage, helpSections);
          });
        });
      }

      function switchPage(paginationItems, targetPage, helpSections) {
        // Update pagination indicators
        paginationItems.forEach((item) => {
          item.classList.remove("active");
          if (item.getAttribute("data-target") === targetPage) {
            item.classList.add("active");
          }
        });

        // Show corresponding content with transition
        helpSections.forEach((section) => {
          section.classList.remove("active");
          if (section.getAttribute("data-page") === targetPage) {
            setTimeout(() => {
              section.classList.add("active");
            }, 10);
          }
        });
      }

      function filterScenes() {
        const searchInput = document.getElementById("searchInput");
        const input = searchInput.value.toLowerCase();
        const suggestions = document.getElementById("searchSuggestions");
        suggestions.innerHTML = "";

        if (!input) return;

        const matches = sceneList.filter((scene) =>
          scene.title.toLowerCase().startsWith(input)
        );

        matches.forEach((scene) => {
          const li = document.createElement("li");
          const thumbUrl = scene.thumbUrl || "default-thumbnail.jpg"; // Fallback thumbnail
          li.className = "search-suggestion-item";

          // Create thumbnail image
          const img = document.createElement("img");
          img.src = thumbUrl;
          img.alt = scene.title;
          img.className = "search-thumb";

          // Create text node
          const span = document.createElement("span");
          span.textContent = scene.title;

          li.appendChild(img);
          li.appendChild(span);

          li.onclick = () => {
            krpano.call(`loadscene(${scene.name}, null, MERGE, BLEND(1));`);
            document.getElementById("searchBox").style.display = "none";
          };
          suggestions.appendChild(li);
        });
      }
    </script>
  </body>
</html>
